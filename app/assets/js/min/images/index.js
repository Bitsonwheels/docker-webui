!function e(t,a,n){function i(r,c){if(!a[r]){if(!t[r]){var o="function"==typeof require&&require;if(!c&&o)return o(r,!0);if(l)return l(r,!0);var s=new Error("Cannot find module '"+r+"'");throw s.code="MODULE_NOT_FOUND",s}var d=a[r]={exports:{}};t[r][0].call(d.exports,function(e){var a=t[r][1][e];return i(a?a:e)},d,d.exports,e,t,a,n)}return a[r].exports}for(var l="function"==typeof require&&require,r=0;r<n.length;r++)i(n[r]);return i}({1:[function(e,t,a){function n(){var e=$(".client-filters").hide(),t=!1,a=0;if(e.find("ul.dropdown-menu").html(""),$.map(m,function(e){g.client||(g.client=e.key),t||g.client!=e.key||(t=e.value),a++}),$("#pull-client-id").val(g.client),e.find(".caption").text(t),!(1>=a)){var n="";$.map(m,function(e){n+='<li><a href="#'+e.key+'">'+e.value+"</a></li>"}),e.find("ul.dropdown-menu").html(n),e.fadeIn(),$("#client-filter .dropdown-menu a").click(function(e){var t=$(this),a=t.closest(".btn-group").removeClass("open");a.find(".caption").text(t.text()).blur(),g.client=t.attr("href").substring(1),d.setProps({reload:!1}),app.func.stop(e)}),$("#pull-client .dropdown-menu a").click(function(e){var t=$(this),a=t.closest(".btn-group").removeClass("open");a.find(".caption").text(t.text()).blur(),$("#pull-client-id").val(t.attr("href").substring(1)),app.func.stop(e)})}}function i(){var e=$(".label-filters").hide(),t=!1,a=0;if(e.find("ul.dropdown-menu").html(""),$.map(p,function(e){t||g.label!=app.func.hash(e.key+"->"+e.value)||(t=e.value),a++}),t||-1!=g.label||(t="Not Labeled"),t&&e.find(".caption").text(t),!(1>=a)){var n='<li><a href="#0">All</a></li>',i="";n+='<li><a href="#-1">Not Labeled</a></li>',$.map(p,function(e){i!=e.key&&(n+='<li class="dropdown-header">'+e.key+"</li>",i=e.key);var t=e.value;t.length>20&&(t=t.substring(0,20)+".."),t="&nbsp;&nbsp;&nbsp;&nbsp;"+t,n+='<li><a href="#'+app.func.hash(e.key+"->"+e.value)+'">'+t+"</a></li>"}),e.find("ul.dropdown-menu").html(n),e.fadeIn(),$("#label-filter .dropdown-menu a").click(function(e){var t=$(this),a=t.closest(".btn-group").removeClass("open");if(a.find(".caption").text(t.text().trim()).blur(),g.label=t.attr("href").substring(1),window.history&&window.history.pushState){var n=0==g.label?"/images":"/images?l="+g.label;history.pushState(null,null,n)}d.setProps({reload:!1}),app.func.stop(e)})}}function l(){var e=$("#search-text").val().replace(/\s/g," ").replace(/　/g," ");e=e.replace(/^\s+|\s+$/gm,"").toUpperCase(),g.text!=e&&(g.text=e,d.setProps({reload:!1}))}function r(e){e=e?e:b,e.format=e.format?e.format:function(e){return JSON.stringify(e,!0," ")},$("#progress-bar").hide().find(".progress-bar").css({width:"0%"});var t=$("#image-detail"),a=t.find(".details");t.find(".detail-title").text(e.title),t.find(".detail-refresh").hide(),e.message?a.text(e.message):a.hide(),app.func.ajax({type:"GET",url:e.url,data:e.conditions,success:function(n){var i=e.format(n);-1==i.indexOf("Error:")?(t.find(".detail-refresh").show(),a.text(i).fadeIn()):a.text(n).fadeIn(),e.callback&&e.callback(),t.modal("show"),b=e},error:function(t,a,n){e.err&&alert(e.err)}})}function c(e,t){h=!0,$("#image-detail").modal("show");var a=e?{client:e}:{};r({title:t,message:"Now executing..\n\ndocker pull "+t,url:"/api/image/pull/"+t,conditions:a,callback:function(){$("#progress-bar").fadeOut()}});var n=$("#progress-bar").show().find(".progress-bar");n.animate({width:"100%"},{duration:45e3,easing:"linear"})}function o(e,t,a,n){var i={repo:a,tag:n};e&&(i.client=e),app.func.ajax({type:"POST",url:"/api/image/tag/"+t,data:i,success:function(e){d.setProps({reload:!0})}})}function s(e,t){var a=0;return $.map(m,function(){a++}),a>1?e:t}var d,u=app.func.query("q"),m=[],p=[],f=[],g={client:app.func.query("c",!1),label:parseInt(app.func.query("l","0"),10),text:""},h=!1,v=!1;""!=u&&(g.text=u.replace(/\s/g," ").replace(/　/g," "),g.text=g.text.replace(/^\s+|\s+$/gm,"").toUpperCase()),$(document).ready(function(){$("#menu-images").addClass("active"),$("#image-detail pre").css({height:$(window).height()-200+"px"}),v="true"==$("#mode-view-only").val();var e=$("#search-text").blur(l);""!=u&&e.val(u),$(".detail-refresh a").click(function(e){r(),app.func.stop(e)}),$("#image-detail").on("hide.bs.modal",function(){h&&d.setProps({reload:!0})}),$("#image-pull").on("show.bs.modal",function(){$("#image-name").val("")}),$("#image-pull").on("shown.bs.modal",function(){$("#image-name").focus()}),$("#image-pull .act-pull").click(function(e){var t=app.func.trim($("#image-name").val());return 0==t.length?($("#image-name").focus(),void app.func.stop(e)):($("#image-pull").modal("hide"),c($("#pull-client-id").val(),t),void app.func.stop(e))}),$("#image-tag").on("shown.bs.modal",function(){$("#image-tag .repository").focus()}),$("#image-tag .act-tag").click(function(e){var t=$("#image-tag"),a=t.find(".client").val();return id=t.find(".image-id").val(),repository=t.find(".repository").val(),tag=t.find(".tag").val(),0==repository.length?(t.find(".repository").focus(),void app.func.stop(e)):(t.modal("hide"),o(a,id,repository,tag),void app.func.stop(e))}),$("#image-run .act-run").click(function(e){$("#image-run").modal("hide")})}),$(window).keyup(function(e){var t=$("#search-text");t.is(":focus")&&l()});var b={},R=React.createClass({displayName:"TableRow",inspect:function(){var e=$(this.getDOMNode()),t=e.attr("data-image-id"),a=e.attr("data-image-name"),n=s({client:e.attr("data-client-id")},"");r({title:a,url:"/api/image/inspect/"+t,conditions:n})},history:function(){var e=$(this.getDOMNode()),t=e.attr("data-image-name"),a=s("?client="+e.attr("data-client-id"),"");app.func.link("/image/history/"+t+a)},run:function(){if(!v){var e=$(this.getDOMNode()),t=(e.attr("data-image-id"),e.attr("data-image-name")),a=$("#image-run");$("#run-scripts").val("docker run "+t),a.find(".detail-title").text("Run from "+t),a.modal("show")}},containers:function(){var e=$(this.getDOMNode()),t=e.attr("data-image-name"),a=s("&c="+e.attr("data-client-id"),"");app.func.link("/?q="+t+a)},pull:function(){if(!v){var e=$(this.getDOMNode()),t=e.attr("data-image-name"),a=s(e.attr("data-client-id"),"");c(a,t)}},rmi:function(){if(!v){var e=$(this.getDOMNode()),t=e.attr("data-image-id"),a=e.attr("data-image-name"),n=s({client:e.attr("data-client-id")},"");(""==a||"<none>:<none>"==a)&&(a=t),window.confirm("Are you sure to remove image: "+a)&&app.func.ajax({type:"POST",url:"/api/image/rmi/"+a,data:n,success:function(e){return"removed successfully."!=e?void alert(e):void d.setProps({reload:!0})}})}},tag:function(){if(!v){var e=$(this.getDOMNode()),t=e.attr("data-image-id"),a=e.attr("data-image-name"),n=s(e.attr("data-client-id"),""),i=$("#image-tag");i.find(".title").text(a),i.find(".client").val(n),i.find(".image-id").val(t),i.find(".repository").val(a.substring(0,a.indexOf(":"))),i.find(".tag").val(a.substring(a.indexOf(":")+1)),i.modal("show")}},render:function(){var e=this.props.content.image,t=this.props.content.tag;return v?React.createElement("tr",{"data-client-id":this.props.content.client,"data-image-id":e.id.substring(0,20),"data-image-name":t},React.createElement("td",{className:"data-index"},e.id.substring(0,10)),React.createElement("td",{className:"data-name"},React.createElement("ul",{className:"nav"},React.createElement("li",{className:"dropdown"},React.createElement("a",{className:"dropdown-toggle","data-toggle":"dropdown",href:"#","aria-expanded":"true"},t),React.createElement("ul",{className:"dropdown-menu"},React.createElement("li",null,React.createElement("a",{onClick:this.inspect},"inspect")),React.createElement("li",null,React.createElement("a",{onClick:this.history},"history")),React.createElement("li",{className:"divider"}),React.createElement("li",null,React.createElement("a",{onClick:this.containers},"containers")))))),React.createElement("td",{className:"data-name"},app.func.byteFormat(e.virtualSize)),React.createElement("td",{className:"data-name"},app.func.relativeTime(new Date(1e3*e.created)))):React.createElement("tr",{"data-client-id":this.props.content.client,"data-image-id":e.id.substring(0,20),"data-image-name":t},React.createElement("td",{className:"data-index"},e.id.substring(0,10)),React.createElement("td",{className:"data-name"},React.createElement("ul",{className:"nav"},React.createElement("li",{className:"dropdown"},React.createElement("a",{className:"dropdown-toggle","data-toggle":"dropdown",href:"#","aria-expanded":"true"},t),React.createElement("ul",{className:"dropdown-menu"},React.createElement("li",null,React.createElement("a",{onClick:this.inspect},"inspect")),React.createElement("li",null,React.createElement("a",{onClick:this.history},"history")),React.createElement("li",{className:"divider"}),React.createElement("li",null,React.createElement("a",{onClick:this.containers},"containers")),React.createElement("li",{className:"divider"}),React.createElement("li",null,React.createElement("a",{onClick:this.pull},"pull again")),React.createElement("li",null,React.createElement("a",{onClick:this.tag},"tag")),React.createElement("li",null,React.createElement("a",{onClick:this.rmi},"rmi")))))),React.createElement("td",{className:"data-name"},app.func.byteFormat(e.virtualSize)),React.createElement("td",{className:"data-name"},app.func.relativeTime(new Date(1e3*e.created))))}}),E=React.createClass({displayName:"Table",getInitialState:function(){return{data:{client:"",images:[]}}},load:function(e){m=[],p=[],app.func.ajax({type:"GET",url:"/api/images",success:function(t){f=t;var a={clients:{},labels:{}},l=$("#filter-label-ids").val();$.map(f,function(e){a.clients[""+e.client.id]=e.client.endpoint.replace(/^.*:\/\//,"").replace(/:.*$/,""),$.map(e.images,function(e){e.labels&&$.map(e.labels,function(e,t){("all"==l||-1!=l.indexOf(t))&&(a.labels[t]||(a.labels[t]={}),a.labels[t][e]=!0)})})}),$.map(a.clients,function(e,t){m.push({key:t,value:e})}),$.map(a.labels,function(e,t){$.map(e,function(e,a){p.push({key:t,value:a})})}),m.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}),p.sort(function(e,t){return e.key<t.key?-1:e.key>t.key?1:e.value<t.value?-1:e.value>t.value?1:0}),n(),i(),e.setState({data:e.filter()})}})},filter:function(){var e={client:"",images:[]};return $.map(f,function(t){t.client.id==g.client&&(e.client=t.client,$.map(t.images,function(t){if(0==g.label||-1==g.label&&!t.labels)e.images.push(t);else{if(!t.labels)return;var a=!1;$.map(t.labels,function(e,t){a|=g.label==app.func.hash(t+"->"+e)}),a&&e.images.push(t)}}))}),e},componentDidMount:function(){this.load(this)},componentWillReceiveProps:function(e){return e.reload?void this.load(this):void this.setState({data:this.filter()})},render:function(){var e=0;if(this.state.data.client)var t=this.state.data.client.id,a=this.state.data.images.map(function(a,n){if(""!=g.text){var i=!0;if($.map(g.text.split(" "),function(e){var t=a.id.substring(0,10).toUpperCase().indexOf(e)>-1;$.map(a.repoTags,function(a){t|=a.toUpperCase().indexOf(e)>-1}),i&=t}),!i)return}return a.repoTags.sort(function(e,t){return e.tag<t.tag?-1:e.tag>t.tag?1:0}),a.repoTags.map(function(i,l){return e++,React.createElement(R,{key:1e3*n+l,content:{client:t,image:a,tag:i}})})});return $("#count").text(e+" image"+(e>1?"s":"")),React.createElement("table",{className:"table table-striped table-hover"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"ID"),React.createElement("th",null,"Repository & Tags"),React.createElement("th",null,"VirtualSize"),React.createElement("th",null,"Created"))),React.createElement("tbody",null,a))}});d=React.render(React.createElement(E,null),document.getElementById("data"))},{}]},{},[1]);