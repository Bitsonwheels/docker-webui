!function e(t,a,n){function l(i,o){if(!a[i]){if(!t[i]){var c="function"==typeof require&&require;if(!o&&c)return c(i,!0);if(r)return r(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var u=a[i]={exports:{}};t[i][0].call(u.exports,function(e){var a=t[i][1][e];return l(a?a:e)},u,u.exports,e,t,a,n)}return a[i].exports}for(var r="function"==typeof require&&require,i=0;i<n.length;i++)l(n[i]);return l}({1:[function(e,t,a){function n(e){var t=$('#refresh-window a[href="#'+e+'"]'),a=t.closest(".btn-group").removeClass("open");u=e,app.storage.set("refresh-window-logs",e),a.find(".caption").text("refresh / "+t.text()).blur()}function l(e){var t=$('#monitoring-count a[href="#'+e+'"]'),a=t.closest(".btn-group").removeClass("open");d=e,app.storage.set("monitoring-count-logs",e),a.find(".caption").text(t.text()).blur()}function r(){u&&u>0&&ReactDOM.render(React.createElement(m,{reload:!0}),document.getElementById("data")),setTimeout(r,1e3*Math.max(1,u))}function i(e){var t=$(".client-filters").hide(),a=!1,n=0;if(t.find("ul.dropdown-menu").html(""),$.map(e,function(e){a||c.client!=e.key||(a=e.value),n++}),a&&t.find(".caption").text(a),!(n<=1)){var l='<li><a href="#-1">All</a></li>';$.map(e,function(e){l+='<li><a href="#'+e.key+'">'+e.value+"</a></li>"}),t.find("ul.dropdown-menu").html(l),t.fadeIn(),$("#client-filter .dropdown-menu a").click(function(e){var t=$(this),a=t.closest(".btn-group").removeClass("open");a.find(".caption").text(t.text()).blur(),c.client=t.attr("href").substring(1),ReactDOM.render(React.createElement(m,{reload:!1}),document.getElementById("data")),app.func.stop(e)})}}function o(e){var t=$(".label-filters").hide(),a=!1,n=0;if(t.find("ul.dropdown-menu").html(""),$.map(e,function(e){a||c.label!=app.func.hash(e.key+"->"+e.value)||(a=e.value),n++}),a||c.label!=-1||(a="Not Labeled"),a&&t.find(".caption").text(a),!(n<=1)){var l='<li><a href="#0">All</a></li>',r="";l+='<li><a href="#-1">Not Labeled</a></li>',$.map(e,function(e){r!=e.key&&(l+='<li class="dropdown-header">'+e.key+"</li>",r=e.key);var t=e.value;t.length>20&&(t=t.substring(0,20)+".."),t="&nbsp;&nbsp;&nbsp;&nbsp;"+t,l+='<li><a href="#'+app.func.hash(e.key+"->"+e.value)+'">'+t+"</a></li>"}),t.find("ul.dropdown-menu").html(l),t.fadeIn(),$("#label-filter .dropdown-menu a").click(function(e){var t=$(this),a=t.closest(".btn-group").removeClass("open");if(a.find(".caption").text(t.text().trim()).blur(),c.label=t.attr("href").substring(1),ReactDOM.render(React.createElement(m,{reload:!1}),document.getElementById("data")),window.history&&window.history.pushState){var n=0==c.label?"/logs":"/logs?l="+c.label;history.pushState(null,null,n)}app.func.stop(e)})}}var c={client:app.func.query("c",-1),label:parseInt(app.func.query("l","0"),10)},s=[],u=app.storage.get("refresh-window-logs",1),d=app.storage.get("monitoring-count-logs",20),p=[];$(document).ready(function(){$("#menu-logs").addClass("active"),n(u),$("#refresh-window a").click(function(e){n(parseInt($(this).attr("href").substring(1),10)),app.func.stop(e)}),l(d),$("#monitoring-count a").click(function(e){l(parseInt($(this).attr("href").substring(1),10)),app.func.stop(e)}),app.func.ajax({url:"/api/containers",data:{status:3},success:function(e){s=e;var t=[],a=[],n={clients:{},labels:{}},l=$("#filter-label-ids").val();$.map(s,function(e){n.clients[""+e.client.id]=e.client.endpoint.replace(/^.*:\/\//,"").replace(/:.*$/,""),$.map(e.containers,function(e){e.labels&&$.map(e.labels,function(e,t){"all"!=l&&l.indexOf(t)==-1||(n.labels[t]||(n.labels[t]={}),n.labels[t][e]=!0)})})}),$.map(n.clients,function(e,a){t.push({key:a,value:e})}),$.map(n.labels,function(e,t){$.map(e,function(e,n){a.push({key:t,value:n})})}),t.sort(function(e,t){return e.value<t.value?-1:e.value>t.value?1:0}),a.sort(function(e,t){return e.key<t.key?-1:e.key>t.key?1:e.value<t.value?-1:e.value>t.value?1:0}),i(t),o(a),r()}})});var f=React.createClass({displayName:"TableRow",statlog:function(){var e=$(ReactDOM.findDOMNode(this)),t=e.attr("data-container-id"),a="?client="+e.attr("data-client-id");app.func.link("/container/statlog/"+t+a)},render:function(){var e=this.props.content,t=e.id.substring(0,20);return React.createElement("tr",{"data-client-id":e.client,"data-container-id":t},React.createElement("td",{className:"data-name no-wrap"},e.time),React.createElement("td",{className:"data-name"},React.createElement("a",{onClick:this.statlog},e.id.substring(0,4))),React.createElement("td",{className:"data-name"},e.type),React.createElement("td",{className:"data-name data-force-break"},e.log.replace(/\[[0-9]+m/g,"")))}}),m=React.createClass({displayName:"Table",propTypes:{reload:React.PropTypes.bool.isRequired},getInitialState:function(){return{data:[]}},load:function(e){var t={count:d};c.client!=-1&&(t.client=c.client),app.func.ajax({url:"/api/logs",data:t,success:function(t){return t.error?void e.setState({data:[]}):(p=t,void e.setState({data:e.filter()}))}})},filter:function(){var e=[],t={};return $.map(s,function(e){$.map(e.containers,function(e){if(0==c.label||c.label==-1&&!e.labels)t[e.id]=!0;else{if(!e.labels)return;var a=!1;$.map(e.labels,function(e,t){a|=c.label==app.func.hash(t+"->"+e)}),a&&(t[e.id]=!0)}})}),$.map(p,function(a){c.client!=-1&&a.client.id!=c.client||$.map(a.logs,function(n){t[n.id]&&($.map(n.stdout,function(t){e.push({client:a.client.id,id:n.id,type:"stdlog",key:t.substring(0,30),time:t.substring(5,19).replace("T"," "),log:t.substring(31)})}),$.map(n.stderr,function(t){e.push({client:a.client.id,id:n.id,type:"stderr",key:t.substring(0,30),time:t.substring(5,19).replace("T"," "),log:t.substring(31)})}))})}),e.sort(function(e,t){var a=new Date(e.key.substring(0,19)+"Z")-new Date(t.key.substring(0,19)+"Z");return 0!=a?a:parseInt(e.key.substring(20),10)-parseInt(t.key.substring(20),10)}),$(".logs").fadeIn(),e},componentDidMount:function(){this.load(this)},componentWillReceiveProps:function(e){return e.reload?void this.load(this):void this.setState({data:this.filter()})},render:function(){var e=[];return this.state.data.map(function(t,a){t.log&&e.push(React.createElement(f,{key:t.client+t.id+t.key,content:t}))}),React.createElement("table",{className:"table table-striped table-hover"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Time"),React.createElement("th",null,"ID"),React.createElement("th",null,"Type"),React.createElement("th",null,"Log"))),React.createElement("tbody",null,e))}});ReactDOM.render(React.createElement(m,{reload:!1}),document.getElementById("data"))},{}]},{},[1]);